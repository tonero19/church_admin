<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Welcome</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

</head>
<body>
<div class="container-fluid">
    <br>

    <nav class="nav nav-pills justify-content-center">
        <a class="nav-link active" href="#">Home</a>
        <a class="nav-link " href="/members">Members</a>
        <a class="nav-link" href="/events">Events</a>
        <a class="nav-link" href="/users">Users</a>
        <a class="nav-link" href="#">Export</a>
        <a class="nav-link" href="/logout">Log Out</a>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-6 ">
                <div id="pie_div" class="d-flex justify-content-center"></div>
<!--                <form action="#" th:object="${startupComponent}" th:action="@{/}" method="post">-->

<!--                    &lt;!&ndash;location combo &ndash;&gt;-->
<!--                    <div class="input-group mb-2 mt-3 ">-->
<!--                        <div class="input-group-prepend"><span class="input-group-text">Location</span></div>-->
<!--                        <select class="form-control" th:field="*{locationName}" required>-->
<!--                            <option th:each="location : ${startupComponent.locationNames}"-->
<!--                                    th:value="${location}"-->
<!--                                    th:text="${location}">-->
<!--                                Location-->
<!--                            </option>-->
<!--                        </select>-->
<!--                    </div>-->
<!--                    &lt;!&ndash; end location combo &ndash;&gt;-->

<!--                    &lt;!&ndash;element combo &ndash;&gt;-->
<!--                    <div class="input-group mb-2 mt-3 ">-->
<!--                        <div class="input-group-prepend"><span class="input-group-text">Element</span></div>-->
<!--                        <select class="form-control" th:field="*{elementName}" required>-->
<!--                            <option th:each="element : ${startupComponent.elementNames}"-->
<!--                                    th:value="${element}"-->
<!--                                    th:text="${element}">-->
<!--                                Element-->
<!--                            </option>-->
<!--                        </select>-->
<!--                    </div>-->
<!--                    &lt;!&ndash; end element combo &ndash;&gt;-->

<!--                    <div class="input-group mb-2 mt-3 ">-->
<!--                        <div class="input-group-prepend"><span class="input-group-text" id="">Start Date</span></div>-->
<!--                        <input type="date" th:field="*{startDate}" th:value="${startDate}" th:text="${startDate}"-->
<!--                               class="form-control" required>-->
<!--                    </div>-->

<!--                    <div class="input-group mb-2 mt-3 ">-->
<!--                        <div class="input-group-prepend"><span class="input-group-text" id="">End Date</span></div>-->
<!--                        <input type="date" th:field="*{endDate}" th:value="${endDate}" th:text="${endDate}"-->
<!--                               class="form-control" required>-->
<!--                    </div>-->

<!--                    <button type="submit" class="btn btn-primary mb-2 offset-9">Update</button>-->
<!--                </form>-->
            </div>


            <!-- --------------------------------- column 2 ------------------------------------------------------------------ -->
            <div class="col-sm-6 ">
<!--                <div class="d-flex justify-content-center">-->
<!--                    <canvas id="chLine" width="600" height="400"></canvas>-->
<!--                </div>-->
                <div id="bar_div" class="d-flex justify-content-center"></div>
<!--                <span class="invisible bg-danger text-white " id="errorMsg">The Value or Limit does not exist for this time range</span>-->
            </div>

            <!-- --------------------------------- column 3 ------------------------------------------------------------------ -->
<!--            <div class="col-sm-3 mb-10 ">-->

<!--                <table class="table table-striped table-dark pb-10">-->
<!--                    <thead>-->
<!--                    <tr>-->
<!--                        <th scope="col" th:style="'background-color: black;'">Title</th>-->
<!--                        <th scope="col" th:style="'background-color: black;'">Value</th>-->
<!--                    </tr>-->
<!--                    </thead>-->
<!--                    <tbody>-->
<!--                    <tr>-->
<!--                        <td>Average Value</td>-->
<!--                        <td><span th:text="${avgValue}"></span></td>-->
<!--                    </tr>-->
<!--                    <tr>-->
<!--                        <td>Average Target</td>-->
<!--                        <td><span th:text="${avgTargetLimit}"></span></td>-->
<!--                    </tr>-->
<!--                    <tr>-->
<!--                        <td>Average Max Limit</td>-->
<!--                        <td><span th:text="${avgMaxLimit}"></span></td>-->
<!--                    </tr>-->
<!--                    <tr>-->
<!--                        <td>Standard Deviation</td>-->
<!--                        <td><span th:text="${stdDev}"></span></td>-->
<!--                    </tr>-->
<!--                    </tbody>-->
<!--                </table>-->

<!--                <br>-->
<!--                <br>-->

<!--                <div id="chart_div" class="d-flex justify-content-center"></div>-->
<!--                <span class="invisible bg-danger text-white " id="errorMsg">The Value or Limit does not exist for this time range</span>-->
                <!--		<div class="d-flex justify-content-center">-->
                <!--			<canvas id="chLine2"></canvas>-->
                <!--		</div>	-->

<!--            </div>-->

        </div>
    </div>
    <br>
</div>


<!--<script type="text/javascript" th:inline="javascript" src="/js/stacked-barchart.js"></script>-->
<!--<script type="text/javascript" th:inline="javascript" src="/js/pie-chart.js"></script>-->

<script type="text/javascript" th:inline="javascript">
		/*<![CDATA[*/

    barCallRestBackend();
    pieCallRestBackend();

    function pieCallRestBackend(){

        $.ajax({

                type : 'GET',
                headers : {
                    Accept : "application/json; charset=utf-8",
                    "Content-Type" : "application/json; charset=utf-8"
                },
                url : 'http://localhost:8080/workers-in-department',
                success : function(result) {
                    console.log('I got here!!!! ==> pieCallRestBackend');
                    google.charts.load('current', {
                        'packages' : ['corechart']
                    });
                    google.charts.setOnLoadCallback(function() {
                        drawPieChart(result);
                        console.log('I got here!!!! ==> pieSetOnLoadCallback');
                    });
                }
            });
    }

function drawPieChart(result){
    console.log('I got here!!!! ==> drawPieChart');

	var data = google.visualization.arrayToDataTable(result);

            var options = {
               width: 800,
               height: 600,
              title: 'Workers in Departments',
              is3D: true
            };

            var chart = new google.visualization.PieChart(document.getElementById('pie_div'));

            chart.draw(data, options);


    console.log('I got here!!!! ==> Pie the end');

}

function barCallRestBackend(){

//google.charts.load('current', {'packages':['bar']});
//console.log('I got here!!!! ==> barCallRestBackend');
$.ajax({

        type : 'GET',
        headers : {
            Accept : "application/json; charset=utf-8",
            "Content-Type" : "application/json; charset=utf-8"
        },
        url : 'http://localhost:8080/come-in-index',
        success : function(result) {
            console.log('I got here!!!! ==> barCallRestBackend');
            google.charts.load('current', {
                'packages' : ['corechart']
            });
            google.charts.setOnLoadCallback(function() {
                drawChart(result);
                console.log('I got here!!!! ==> setOnLoadCallback');
            });
        }
    });
}

function drawChart(result){
    console.log('I got here!!!! ==> drawChart');
	// chart colors
	//let colors = ['#007bff','#28a745','#333333','#c3e6cb','#dc3545','#ff0000'];

	//console.log('Labels:'+result['labels']);
	//console.log('value-1: '+result['line-1']);

	/* large line chart */
	let chLine = document.getElementById("chLine");
	//let chLine2 = document.getElementById("chLine2");
	var data = google.visualization.arrayToDataTable(result);

	var options = {
            width: 800,
            height: 600,
            legend: { position: 'top', maxLines: 3 },
            bar: { groupWidth: '75%' },
            isStacked: true
          };

    var chart = new google.visualization.BarChart(document.getElementById('bar_div'));
    chart.draw(data, options);

    console.log('I got here!!!! ==> the end');

}

</script>

</body>
</html>